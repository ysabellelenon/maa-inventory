{% extends "maainventory/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/inventory.css' %}">
{% endblock %}

{% block content %}
  <div class="page-header inventory-header">
    <h2>Inventory</h2>
  </div>

  <div class="inventory-container">
    <div class="inventory-card">
      <div class="table-actions">
        <div class="table-actions-left">
          <div class="table-search">
            <img src="{% static 'icons/search.svg' %}" class="table-search-icon" alt="Search" />
            <input class="table-search-input" placeholder="Search by item or code" aria-label="Search inventory" />
          </div>
          <button class="btn-filter">
            <img src="{% static 'icons/filter.svg' %}" alt="" />
            <span>Filter</span>
          </button>
        </div>
      </div>
      <table class="inventory-table">
        <thead>
          <tr>
            <th class="col-check"></th>
            <th class="col-expand"></th>
            <th class="col-code">Item Code</th>
            <th class="col-name">Item Name</th>
            <th class="col-desc">Description</th>
            <th class="col-init">Qty</th>
            <th class="col-remain">Remaining</th>
            <th class="col-min">MIN</th>
            <th class="col-status">Status</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
            <tr class="inventory-row {% if item.status == 'LOW' %}row-low{% endif %}">
              <td class="col-check"><input type="checkbox" aria-label="select {{ item.code }}" /></td>
              <td class="col-expand">
                <button class="expand" aria-hidden="true">
                  <img class="expand-icon" src="{% static 'icons/chevron-right.svg' %}" alt="" />
                </button>
              </td>
              <td class="col-code">{{ item.code }}</td>
              <td class="col-name">
                <img class="item-thumb" src="{% static 'images/sample-item.jpg' %}" alt="" />
                <div class="item-meta">
                  <div class="item-title">{{ item.name }}</div>
                </div>
              </td>
              <td class="col-desc">{{ item.desc }}</td>
              <td class="col-init">{{ item.initial_qty }}</td>
              <td class="col-remain">{{ item.remaining_qty }}</td>
              <td class="col-min">{{ item.min_qty }}</td>
              <td class="col-status">
                <span class="status-pill {% if item.status == 'LOW' %}status-low{% else %}status-good{% endif %}">{{ item.status }}</span>
              </td>
            </tr>
            <tr class="inventory-details" hidden>
              <td colspan="9">
                <div class="details-inner">
                  <div class="details-header">Details</div>
                  <div class="details-grid">
                    <div class="detail-item">
                      <div class="detail-label">Foodics</div>
                      <div class="detail-value">{{ item.foodics|default:"123" }}</div>
                    </div>
                    <div class="detail-item">
                      <div class="detail-label">Talabat</div>
                      <div class="detail-value">{{ item.talabat|default:"45" }}</div>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
      <div class="table-footer">
        <div class="table-footer-left">
          <label class="show-label">Show
            <select class="page-size" aria-label="Results per page">
              <option value="10" selected>10</option>
              <option value="25">25</option>
              <option value="50">50</option>
            </select>
          </label>
          <span class="entries-info">Showing 1 to 10 of 50 entries</span>
        </div>
        <div class="table-footer-right">
          <nav class="pagination" aria-label="Pagination">
            <button class="page-prev" aria-label="Previous page">
              <img src="{% static 'icons/chevron-left.svg' %}" alt="Prev" />
            </button>
            <button class="page-num active" aria-current="page">1</button>
            <button class="page-num">2</button>
            <button class="page-num">3</button>
            <span class="page-dots">â€¦</span>
            <button class="page-num">10</button>
            <button class="page-next" aria-label="Next"">
              <img src="{% static 'icons/chevron-right.svg' %}" alt="Next" />
            </button>
          </nav>
        </div>
      </div>
    </div>
  </div>

<script>
  (function () {
    var rightIcon = "{% static 'icons/chevron-right.svg' %}";
    var downIcon = "{% static 'icons/chevron-down.svg' %}";
    function toggleRow(button) {
      var row = button.closest('tr');
      if (!row) return;
      var details = row.nextElementSibling;
      var img = button.querySelector('img.expand-icon');
      var expanded = row.classList.toggle('expanded');
      if (details && details.classList.contains('inventory-details')) {
        if (expanded) {
          details.removeAttribute('hidden');
        } else {
          details.setAttribute('hidden', '');
        }
      }
      if (img) {
        img.setAttribute('src', expanded ? downIcon : rightIcon);
      }
      // update aria-expanded
      button.setAttribute('aria-expanded', expanded ? 'true' : 'false');
    }

    document.addEventListener('click', function (e) {
      var btn = e.target.closest && e.target.closest('.expand');
      if (btn) {
        e.preventDefault();
        toggleRow(btn);
      }
    });
  })();
</script>

{% endblock %}

 
